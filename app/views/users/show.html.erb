<div class="user-profile">

  <div class="profile-header-border">
    <div class="profile-header">
      <h1><%= @profile_user.username %></h1>

      <span>Member since: <%= @profile_user.created_at.strftime('%e %b %Y %I:%M%p') %></span>

      <% if @follow %>
        <button id="/users/<%= @user.id %>/follows/<%= @profile_user.id %>" class="button followed-button">following</button>
      <% else %>
        <button id="/users/<%= @user.id %>/follows/<%= @profile_user.id %>" class="button follow-button">follow</button>
      <% end %>
    </div>
  </div>


  <%= image_tag 'smiley.png' %>

  <div class="profile-description"><%= @profile_user.description %></div>


</div>

<div class="profile-starts-display">
  <div class="profile-tab">Showing: Created Stories <span id="contribution-tab">Contributions</span></div>

  <%= render @starts, locals: {addition: @addition} %>
</div>

<div class="profile-additions-display">
  <div class="profile-tab">Showing: Contributions <span id="create-tab">Created Stories</span></div>

  <% @addition_starts.each do |start| %>

    <div class="story-blurb">

      <div class="blurb-functional">
        <button class="button">❤︎</button>
        <p>Last updated: <%= start.updated_at.strftime('%e %b %Y %I:%M%p') %></p>

        <p id='<%= start.user_id %>' class="story-blurb-username">By:
          <a href='/users/<%= start.user.id %>'><%= start.user.username %></a></p>

        <p>Created at: <%= start.created_at.strftime('%e %b %Y %I:%M%p') %></p>

        <p>Additions: <%= start.additions.count %></p>

        <p>Status: <%= start.completed ? 'Complete' : 'Ongoing' %></p>

      </div>
      <div id="/starts/<%= start.id.to_s %>" class="blurb-story">

        <h1 class="story-blurb-title"><%= start.title %></h1>

        <p class="flash"></p>

        <p><%= start.story_text %></p>

        <div class="closed-story-blurb">
          <% start.additions.each do |addition| %>
            <p><%= addition.addition_text %></p>
          <% end %>
        </div>

        <div class="addition-form">
          <p class="flash"></p>
          <%= form_for @addition, url: "/starts/#{start.id}/additions" do |f| %>
            <%= f.label 'Write your addition here!' %>
            <%= f.text_area :addition_text, class: 'textfield textarea addition-text' %>

            <p>Remaining characters: <span id="remaining-characters">140</span></p>

            <%= f.submit 'Create Addition', class: 'addition-button button' %>
          <% end %>

        </div>

      </div>
    </div>
  <% end %>
</div>